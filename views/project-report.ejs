<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title><%= departmentTitle %> Project Reports</title>
    <link rel="stylesheet" href="/styles.css"> <!-- Link to external CSS -->
</head>

<body>
    <!-- Header Section -->
    <div id="header-container"></div>

    <!-- Contact Us Section -->
    <section class="contact-section">
        <div class="container">
            <p><strong>Contact us:</strong> WhatsApp: <a href="https://wa.me/917603846096" target="_blank"><strong>+91 7603846096</strong></a></p>
        </div>
    </section>

    <!-- Project Images and Text Section -->
    <section class="img-section">
        <div class="img">
                <img src="https://res.cloudinary.com/dqm6x3gnp/image/upload/v1723915098/PROJECT%20SAMPLE%20IMG/o0bbgepytt38o0mp7qqz.jpg" alt="Word/PPT Only" class="project-image" onclick="openFullscreen(this)">
        </div>
        <div class="img">
                <img src="https://res.cloudinary.com/dqm6x3gnp/image/upload/v1723915098/PROJECT%20SAMPLE%20IMG/bfsmnbvwrbs4wx8a4ibi.jpg" alt="Full Project Book" class="project-image" onclick="openFullscreen(this)">
        </div>
    </section>

    <!-- Project Table Section -->
    <section class="content-section">
        <div class="container1">
            <h2><%= departmentTitle %> Project Reports</h2>
            <table class="project-table">
                <thead>
                    <tr>
                        <th><%= departmentTitle %> PROJECT REPORTS</th>
                        <th>
                            <p>Word/PPT only (You need to add your name and front pages)</p>
                        </th>
                        <th>
                            <p>Full project book (Includes your details: name, college) Home delivery (if possible)</p>
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <% projects.forEach(function(project, index) { %>
                        <tr>
                            <td><%= index + 1 %>. <%= project.title %></td>
                            <td><button onclick="initiatePayment('<%= project.id %>')">Download (Rs 100)</button></td>
                            <td><button onclick="orderProject('<%= project.title %>')">Order Project</button></td>
                        </tr>
                    <% }); %>
                </tbody>
            </table>
        </div>
    </section>

    <!-- Footer Section -->
    <div id="footer-container"></div>

    <script>
        let fullscreenContainer;

        function openFullscreen(img) {
            fullscreenContainer = document.createElement("div");
            fullscreenContainer.classList.add("fullscreen-image");

            const fullscreenImg = img.cloneNode();
            fullscreenImg.style.width = 'auto';
            fullscreenImg.style.height = 'auto';
            fullscreenContainer.appendChild(fullscreenImg);

            document.body.appendChild(fullscreenContainer);

            history.pushState({fullscreen: true}, null, "");

            fullscreenContainer.onclick = function () {
                closeFullscreen();
            };
        }

        function closeFullscreen() {
            if (fullscreenContainer) {
                document.body.removeChild(fullscreenContainer);
                fullscreenContainer = null;
            }
        }

        window.onpopstate = function(event) {
            if (event.state && event.state.fullscreen) {
                closeFullscreen();
            }
        };

        function initiatePayment(projectID) {
            const options = {
                // Razorpay configuration here
                "key": "YOUR_RAZORPAY_KEY",
                "amount": 10000, // Amount in paise (10000 paise = 100 INR)
                "currency": "INR",
                "name": "PROJECT BUILDERS",
                "description": "Purchase Project Report",
                "handler": function (response) {
                    // Payment successful, redirect to handler with project ID
                    const redirectURL = `/handler.html?project=${projectID}&payment_id=${response.razorpay_payment_id}`;
                    window.location.href = redirectURL;
                },
                "prefill": {
                    "name": "Your Customer Name",
                    "email": "customer@example.com",
                    "contact": "9999999999"
                },
                "notes": {
                    "address": "Your Company Address"
                },
                "theme": {
                    "color": "#3399cc"
                }
            };

            const rzp1 = new Razorpay(options);
            rzp1.open();
    }


        function orderProject(projectTitle) {
            const whatsappUrl = `https://wa.me/917603846096?text=I%20would%20like%20to%20order%20the%20project:%20${encodeURIComponent(projectTitle)}`;
            window.location.href = whatsappUrl;
        }
    </script>

    <script src="/header-footer.js"></script>
</body>
</html>
